class PlanViewerView{constructor(app){this.app=app}async render(){const p=await this.app.api.getPlans();const plans=p.plans||[];document.getElementById('view').innerHTML=`<div class='card'><h3>Plans</h3>${UIComponents.table(['Name','Status','Steps','Actions'],plans.map(x=>[x.name,x.status,(x.steps||[]).length,`<button class='btn' data-id='${x.id}'>View Graph</button>`]))}</div><div id='graph' class='card'><h3>Graph</h3></div>`;document.querySelectorAll('[data-id]').forEach(b=>b.onclick=()=>this.showGraph(b.dataset.id))}async showGraph(id){const g=await this.app.api.getPlanGraph(id);const el=document.getElementById('graph');el.innerHTML=`<h3>Execution Graph</h3><svg viewBox='0 0 640 160'>${(g.nodes||[]).map((n,i)=>`<circle cx='${80+i*160}' cy='80' r='24' fill='${n.status==='running'?'#d29922':'#3fb950'}'/><text x='${70+i*160}' y='86' fill='#fff'>${n.label}</text>`).join('')}${(g.edges||[]).map((e,i)=>`<line x1='${104+i*160}' y1='80' x2='${136+i*160}' y2='80' stroke='#58a6ff'/>`).join('')}</svg>`}};window.PlanViewerView=PlanViewerView;
