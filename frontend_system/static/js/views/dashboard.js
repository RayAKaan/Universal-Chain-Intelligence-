class DashboardView{constructor(app){this.app=app;this.chart=new SimpleChart();this.topology=new TopologyView()}async mount(){const d=await this.app.api.getDashboard();const v=this.app.view;v.innerHTML=`<div class='view-grid cols-4 stagger-in'>${UIComponents.metricCard('Health Score',Math.round((d.score||0)*100)+'%','stable')}${UIComponents.metricCard('Active Goals',d.active_goals,'live')}${UIComponents.metricCard('Capabilities',d.capability_count,'registered')}${UIComponents.metricCard('Improvements',d.improvements_applied,'cumulative')}</div><div class='view-grid cols-2' style='margin-top:14px'><section class='card'><div class='card-header'><div class='card-title'>System Topology</div></div><div class='card-body'><div id='topology'></div></div></section><section class='card'><div class='card-header'><div class='card-title'>Phase Health Matrix</div></div><div class='card-body'>${Object.entries(d.phases||{}).map(([k,val])=>`<div style='display:flex;justify-content:space-between;align-items:center'><span>${k}</span><span><span class='status-dot ${val}'></span> ${val}</span></div>`).join('')}</div></section><section class='card'><div class='card-header'><div class='card-title'>Resources</div></div><div class='card-body'><div id='gauges'></div></div></section><section class='card'><div class='card-header'><div class='card-title'>Live Activity</div></div><div class='card-body'>${UIComponents.timeline(d.recent_activity||[])}</div></section><section class='card'><div class='card-header'><div class='card-title'>Goal Distribution</div></div><div class='card-body'><div id='donut'></div></div></section><section class='card'><div class='card-header'><div class='card-title'>Safety & Alignment</div></div><div class='card-body'><div id='align'></div><div class='chip'>${d.safety?.trust_tier||'N/A'}</div></div></section></div><section class='card' style='margin-top:14px'><div class='card-body'><button class='btn btn-primary' id='qa-goal'>◎ Submit Goal</button> <button class='btn' id='qa-disc'>◇ Discovery</button> <button class='btn' id='qa-imp'>△ Improve</button> <button class='btn' id='qa-health'>♡ Health</button></div></section>`;this.topology.render(document.getElementById('topology'),Object.keys(d.phases||{}));this.chart.barChart(document.getElementById('gauges'),[{label:'CPU',value:d.resources?.cpu||0},{label:'Memory',value:d.resources?.memory||0},{label:'Disk',value:d.resources?.disk||0}]);this.chart.donutChart(document.getElementById('donut'),[{label:'active',value:d.goal_breakdown?.active||0,color:'var(--accent-cyan)'},{label:'completed',value:d.goal_breakdown?.completed||0,color:'var(--accent-emerald)'},{label:'failed',value:d.goal_breakdown?.failed||0,color:'var(--accent-crimson)'},{label:'queued',value:d.goal_breakdown?.queued||0,color:'var(--accent-amber)'}]);this.chart.gaugeChart(document.getElementById('align'),Math.round((d.safety?.alignment_score||0)*100),100);document.getElementById('qa-goal').onclick=()=>this.app.router.go('/goals');document.getElementById('qa-health').onclick=()=>this.app.router.go('/health')}} window.DashboardView=DashboardView;
